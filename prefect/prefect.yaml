build:
- prefect_docker.deployments.steps.build_docker_image:
    id: build-image
    requires: prefect-docker>=0.3.0
    image_name: europe-west6-docker.pkg.dev/amazing-thought-394210/test/latest-image-9
    tag: 2.6.5-python3.10
    dockerfile: auto
    push: true

build:
- prefect_gcp.deployments.steps.push_to_gcs:
    requires: prefect-gcp
    bucket: bucket
    folder: ./
    credentials: "{{ prefect.blocks.gcp-credentials.my-gcp }}"

push:
- prefect_aws.deployments.steps.push_to_s3:
    id: push-code
    requires: prefect-gcp
    bucket: bucket
    folder: ./
    credentials: "{{ prefect.blocks.gcp-credentials.my-gcp }}"

pull:
- prefect_aws.deployments.steps.pull_from_s3:
    id: pull-code
    requires: prefect-gcp
    bucket: bucket
    folder: "{{ push-code.folder }}"
    credentials: "{{ prefect.blocks.gcp-credentials.my-gcp }}"


deployments:
- name: test
  entrypoint: etl_web_to_gcs.py:etl_web_to_gcs
  work_pool:
    name: "my-push-pool"


